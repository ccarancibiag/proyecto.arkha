{% load static %}
<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8">
    <title>Proyecto Arkha</title>
    <style>
            body {
        background-image: url("{% static 'images/playa_fondo.jpg' %}");
        animation: scroll-playa 60s linear infinite;
        margin: 0;
        padding: 0;
        font-family: sans-serif;
      }

      @keyframes scroll-playa {
        from {
          background-position: 0 0;
        }
        to {
          background-position: -3840px 0;
        }
      }

      .contenedor {
        max-width: 800px;
        margin: 20px auto;
        padding: 20px;
        border: 1px solid #ccc;
        border-radius: 8px;
        background: white;
      }

      .estado {
        background: #f4f4f4;
        padding: 10px;
        border-radius: 5px;
      }

      .pregunta {
        margin-top: 20px;
      }

      .alternativas {
        list-style: none;
        padding: 0;
      }

      .alternativas li {
        margin: 10px 0;
      }

      button {
        padding: 10px 15px;
        background: #475fff;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
      }

      .messages {
        list-style: none;
        padding: 0;
        margin: 0 0 20px 0;
      }

      .messages li {
        padding: 10px;
        border-radius: 5px;
        font-weight: bold;
        margin-bottom: 10px;
      }

      .messages li.error {
        background: #f8d7da;
        color: #721c24;
      }
    </style>
    <div style="
    position: absolute; 
    top: 20px; 
    right: 20px; 
    background: #f0f0f0; 
    padding: 12px 15px; 
    border-radius: 8px; 
    border: 1px solid #ccc;
    box-shadow: 0px 0px 8px rgba(0,0,0,0.15);
    font-family: 'Courier New', monospace;
    text-transform: uppercase;
    text-align: right;
    ">
    {% for tipo, datos in stats_tipos.items %}
        <p style="margin: 2px 0;">
            {{ tipo }}: {{ datos.porcentaje }}% ({{ datos.correctas }}/{{ datos.total }})
        </p>
    {% endfor %}
</div>

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </head>
  <body>
    <div class="contenedor">
      {% if messages %}
      <ul class="messages">
        {% for message in messages %}
        <li class="{{ message.tags }}">{{ message }}</li>
        {% endfor %}
      </ul>
      {% endif %}

      <h1>Pregunta</h1>

      <div class="estado">
        <p>Nivel Actual: {{ nivel }}</p>
        <p><strong>Racha de respuestas consecutivas:</strong></p>
        <p>Correctas: {{ correctas }}</p>
        <p>Incorrectas: {{ incorrectas }}</p>
      </div>

      {% if pregunta %}
      <div class="pregunta">
        <h3>{{ pregunta.pregunta }}</h3>
        <form method="POST">
          {% csrf_token %}
          <input type="hidden" name="pregunta_id" value="{{ pregunta.id }}">
          <ul class="alternativas">
            <li>
              <label>
                <input type="radio" name="respuesta" value="A" required>
                {{ pregunta.alternativa_A }}
              </label>
            </li>
            <li>
              <label>
                <input type="radio" name="respuesta" value="B" required>
                {{ pregunta.alternativa_B }}
              </label>
            </li>
            <li>
              <label>
                <input type="radio" name="respuesta" value="C" required>
                {{ pregunta.alternativa_C }}
              </label>
            </li>
            <li>
              <label>
                <input type="radio" name="respuesta" value="D" required>
                {{ pregunta.alternativa_D }}
              </label>
            </li>
          </ul>
          <button type="submit">Enviar Respuesta</button>
        </form>
      </div>
      {% else %}
      <h2>No hay preguntas para este nivel</h2>
      {% endif %}
    </div>
    <div style="margin-bottom: 20px;">
      <a href="/reiniciar/">
        <button type="button" style="background: #ff4747;">
          Reiniciar cuestionario
        </button>
      </a>
    </div>
  </body>
</html>